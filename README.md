# 📊 Daily Budget Tracker

ホテル向けの **日別予算・ローリングフォーキャスト・実績比較** を支援するExcel出力ツールです。  
予算と実績の差異を視覚化し、ローリングで着地予測や修正を行う業務を効率化します。

---

## 🚀 主な機能

- ✅ **横持ち形式**の日別予実フォーマットをExcelで自動生成  
- ✅ **予算 / FC（ローリングフォーキャスト） / 実績** を1行にまとめて比較可能  
- ✅ **OCC・ADR・RevPAR・DOR** をExcel関数で自動計算  
- ✅ **差異列（FC−予算、実績−FC）** を自動表示（OCC / ADR / 売上のみ）  
- ✅ 実績入力済みの日付に対して **FCセルを自動グレー化**（条件付き書式）  
- ✅ 曜日列に応じた **色分け（例：土曜＝青、日祝＝赤）**  
- ✅ 月別シートに加えて、**年間集計シート**を自動生成  
- ✅ GUIで **キャパシティ（部屋数）・期首月** を指定可能  
- ✅ `.exe` 化で非エンジニアでも利用可能（※予定）  

---

## 📂 フォルダ構成（予定）

```
daily-budget-tracker/
├── forecast_generator.py       # メインスクリプト（Excel出力）
├── README.md
├── requirements.txt            # 必要なPythonライブラリ
└── sample/
    └── 日別予算_2025.xlsx     # 入力用サンプルExcelファイル
```

---

## 🛠️ 使用方法

1. Python 3.x をインストール（推奨：3.10以上）  
2. 必要ライブラリをインストール：

```bash
pip install pandas openpyxl jpholiday
```
※Tkinter が入っていない環境では別途 `python3-tk` パッケージのインストールが必要です。

3. スクリプトを実行：

```bash
python forecast_generator.py
```

4. GUIで以下を指定：  
   - 宿泊キャパシティ（部屋数）  
   - 期首月（1〜12）  
   - 入力ファイル（例：`日別予算_2025.xlsx`）

5. 自動で `予実管理表_2025年度.xlsx` が生成されます。

---

## 🧮 入力ファイル（フォーマット要件）

- Excelファイル（例：`日別予算_2025.xlsx`）
- シートごとに対象月のデータ
- 各シートに以下の列を含む必要あり：

| 日付 | 種別（予算/FC/実績） | 室数 | 人数 | 宿泊売上 |
|------|----------------------|------|------|------------|

---

## 📅 出力形式（サンプル）

| 日付       | 曜日 | 室数_予算 | ... | 室数_FC | ... | 室数_実績 | ... | 差_OCC_FC-予算 | ... |
|------------|------|------------|-----|----------|-----|------------|-----|------------------|-----|
| 2025/04/01 | 火   | 50         |     | 48       |     | 47         |     | -2.0%            |     |

---

## 📌 注意点

- 実績が未入力の日程は、月次予測に **FC値を加算**して着地予測を補完できます  
- 本ツールは宿泊部門専用設計です。朝食やF&B部門には未対応（拡張予定）

---

## 📈 今後のアップデート予定

- 修正月次予測の自動表示  
- 達成率に応じたセル色分け  
- F&B部門データの取り込み  
- クラウド保存・共有用テンプレートとの連携

---

## 📮 ご意見・お問い合わせ

不具合報告や改善提案は [Issues](https://github.com/yourname/daily-budget-tracker/issues) までお願いします。

---

## 🧑‍💻 開発者

- Created by [Your Name / Company]  
- LinkedIn / Twitter / Website（任意で追加）

---
